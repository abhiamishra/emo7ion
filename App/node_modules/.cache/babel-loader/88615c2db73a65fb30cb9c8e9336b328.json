{"ast":null,"code":"import * as tf from '@tensorflow/tfjs-core';\nimport { convLayer } from '../common';\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\nimport { prelu } from './prelu';\nimport { sharedLayer } from './sharedLayers';\nexport function ONet(x, params) {\n  return tf.tidy(function () {\n    var out = sharedLayer(x, params);\n    out = tf.maxPool(out, [2, 2], [2, 2], 'same');\n    out = convLayer(out, params.conv4, 'valid');\n    out = prelu(out, params.prelu4_alpha);\n    var vectorized = tf.reshape(out, [out.shape[0], params.fc1.weights.shape[0]]);\n    var fc1 = fullyConnectedLayer(vectorized, params.fc1);\n    var prelu5 = prelu(fc1, params.prelu5_alpha);\n    var fc2_1 = fullyConnectedLayer(prelu5, params.fc2_1);\n    var max = tf.expandDims(tf.max(fc2_1, 1), 1);\n    var prob = tf.softmax(tf.sub(fc2_1, max), 1);\n    var regions = fullyConnectedLayer(prelu5, params.fc2_2);\n    var points = fullyConnectedLayer(prelu5, params.fc2_3);\n    var scores = tf.unstack(prob, 1)[1];\n    return {\n      scores: scores,\n      regions: regions,\n      points: points\n    };\n  });\n}","map":{"version":3,"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,uBAApB;AAEA,SAASC,SAAT,QAA0B,WAA1B;AACA,SAASC,mBAAT,QAAoC,+BAApC;AACA,SAASC,KAAT,QAAsB,SAAtB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AAGA,OAAM,SAAUC,IAAV,CAAeC,CAAf,EAA+BC,MAA/B,EAAiD;AACrD,SAAOP,EAAE,CAACQ,IAAH,CAAQ;AAEb,QAAIC,GAAG,GAAGL,WAAW,CAACE,CAAD,EAAIC,MAAJ,CAArB;AACAE,OAAG,GAAGT,EAAE,CAACU,OAAH,CAAWD,GAAX,EAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB,EAAwB,CAAC,CAAD,EAAI,CAAJ,CAAxB,EAAgC,MAAhC,CAAN;AACAA,OAAG,GAAGR,SAAS,CAACQ,GAAD,EAAMF,MAAM,CAACI,KAAb,EAAoB,OAApB,CAAf;AACAF,OAAG,GAAGN,KAAK,CAAcM,GAAd,EAAmBF,MAAM,CAACK,YAA1B,CAAX;AAEA,QAAMC,UAAU,GAAGb,EAAE,CAACc,OAAH,CAAWL,GAAX,EAAgB,CAACA,GAAG,CAACM,KAAJ,CAAU,CAAV,CAAD,EAAeR,MAAM,CAACS,GAAP,CAAWC,OAAX,CAAmBF,KAAnB,CAAyB,CAAzB,CAAf,CAAhB,CAAnB;AACA,QAAMC,GAAG,GAAGd,mBAAmB,CAACW,UAAD,EAAaN,MAAM,CAACS,GAApB,CAA/B;AACA,QAAME,MAAM,GAAGf,KAAK,CAAca,GAAd,EAAmBT,MAAM,CAACY,YAA1B,CAApB;AACA,QAAMC,KAAK,GAAGlB,mBAAmB,CAACgB,MAAD,EAASX,MAAM,CAACa,KAAhB,CAAjC;AACA,QAAMC,GAAG,GAAGrB,EAAE,CAACsB,UAAH,CAActB,EAAE,CAACqB,GAAH,CAAOD,KAAP,EAAc,CAAd,CAAd,EAAgC,CAAhC,CAAZ;AAEA,QAAMG,IAAI,GAAGvB,EAAE,CAACwB,OAAH,CAAWxB,EAAE,CAACyB,GAAH,CAAOL,KAAP,EAAcC,GAAd,CAAX,EAA+B,CAA/B,CAAb;AACA,QAAMK,OAAO,GAAGxB,mBAAmB,CAACgB,MAAD,EAASX,MAAM,CAACoB,KAAhB,CAAnC;AACA,QAAMC,MAAM,GAAG1B,mBAAmB,CAACgB,MAAD,EAASX,MAAM,CAACsB,KAAhB,CAAlC;AAEA,QAAMC,MAAM,GAAG9B,EAAE,CAAC+B,OAAH,CAAWR,IAAX,EAAiB,CAAjB,EAAoB,CAApB,CAAf;AACA,WAAO;AAAEO,YAAM,QAAR;AAAUJ,aAAO,SAAjB;AAAmBE,YAAM;AAAzB,KAAP;AACD,GAnBM,CAAP;AAoBD","names":["tf","convLayer","fullyConnectedLayer","prelu","sharedLayer","ONet","x","params","tidy","out","maxPool","conv4","prelu4_alpha","vectorized","reshape","shape","fc1","weights","prelu5","prelu5_alpha","fc2_1","max","expandDims","prob","softmax","sub","regions","fc2_2","points","fc2_3","scores","unstack"],"sources":["../../../src/mtcnn/ONet.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}