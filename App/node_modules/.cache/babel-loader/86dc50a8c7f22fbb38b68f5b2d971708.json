{"ast":null,"code":"import * as tf from '@tensorflow/tfjs-core';\n/**\r\n * Pads the smaller dimension of an image tensor with zeros, such that width === height.\r\n *\r\n * @param imgTensor The image tensor.\r\n * @param isCenterImage (optional, default: false) If true, add an equal amount of padding on\r\n * both sides of the minor dimension oof the image.\r\n * @returns The padded tensor with width === height.\r\n */\n\nexport function padToSquare(imgTensor, isCenterImage) {\n  if (isCenterImage === void 0) {\n    isCenterImage = false;\n  }\n\n  return tf.tidy(function () {\n    var _a = imgTensor.shape.slice(1),\n        height = _a[0],\n        width = _a[1];\n\n    if (height === width) {\n      return imgTensor;\n    }\n\n    var dimDiff = Math.abs(height - width);\n    var paddingAmount = Math.round(dimDiff * (isCenterImage ? 0.5 : 1));\n    var paddingAxis = height > width ? 2 : 1;\n\n    var createPaddingTensor = function (paddingAmount) {\n      var paddingTensorShape = imgTensor.shape.slice();\n      paddingTensorShape[paddingAxis] = paddingAmount;\n      return tf.fill(paddingTensorShape, 0);\n    };\n\n    var paddingTensorAppend = createPaddingTensor(paddingAmount);\n    var remainingPaddingAmount = dimDiff - paddingTensorAppend.shape[paddingAxis];\n    var paddingTensorPrepend = isCenterImage && remainingPaddingAmount ? createPaddingTensor(remainingPaddingAmount) : null;\n    var tensorsToStack = [paddingTensorPrepend, imgTensor, paddingTensorAppend].filter(function (t) {\n      return !!t;\n    }).map(function (t) {\n      return t.toFloat();\n    });\n    return tf.concat(tensorsToStack, paddingAxis);\n  });\n}","map":{"version":3,"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,uBAApB;AAEA;;;;;;;;;AAQA,OAAM,SAAUC,WAAV,CACJC,SADI,EAEJC,aAFI,EAE0B;AAA9B;AAAAA;AAA8B;;AAE9B,SAAOH,EAAE,CAACI,IAAH,CAAQ;AAEP;AAAA,QAACC,cAAD;AAAA,QAASC,aAAT;;AACN,QAAID,MAAM,KAAKC,KAAf,EAAsB;AACpB,aAAOJ,SAAP;AACD;;AAED,QAAMK,OAAO,GAAGC,IAAI,CAACC,GAAL,CAASJ,MAAM,GAAGC,KAAlB,CAAhB;AACA,QAAMI,aAAa,GAAGF,IAAI,CAACG,KAAL,CAAWJ,OAAO,IAAIJ,aAAa,GAAG,GAAH,GAAS,CAA1B,CAAlB,CAAtB;AACA,QAAMS,WAAW,GAAGP,MAAM,GAAGC,KAAT,GAAiB,CAAjB,GAAqB,CAAzC;;AAEA,QAAMO,mBAAmB,GAAG,UAACH,aAAD,EAAsB;AAChD,UAAMI,kBAAkB,GAAGZ,SAAS,CAACa,KAAV,CAAgBC,KAAhB,EAA3B;AACAF,wBAAkB,CAACF,WAAD,CAAlB,GAAkCF,aAAlC;AACA,aAAOV,EAAE,CAACiB,IAAH,CAAQH,kBAAR,EAA4B,CAA5B,CAAP;AACD,KAJD;;AAMA,QAAMI,mBAAmB,GAAGL,mBAAmB,CAACH,aAAD,CAA/C;AACA,QAAMS,sBAAsB,GAAGZ,OAAO,GAAIW,mBAAmB,CAACH,KAApB,CAA0BH,WAA1B,CAA1C;AAEA,QAAMQ,oBAAoB,GAAGjB,aAAa,IAAIgB,sBAAjB,GACzBN,mBAAmB,CAACM,sBAAD,CADM,GAEzB,IAFJ;AAIA,QAAME,cAAc,GAAG,CACrBD,oBADqB,EAErBlB,SAFqB,EAGrBgB,mBAHqB,EAKpBI,MALoB,CAKb,aAAC;AAAI,cAAC,CAACC,CAAF;AAAG,KALK,EAMpBC,GANoB,CAMhB,UAACD,CAAD,EAAa;AAAK,cAAC,CAACE,OAAF;AAAW,KANb,CAAvB;AAOA,WAAOzB,EAAE,CAAC0B,MAAH,CAAUL,cAAV,EAA0BT,WAA1B,CAAP;AACD,GAhCM,CAAP;AAiCD","names":["tf","padToSquare","imgTensor","isCenterImage","tidy","height","width","dimDiff","Math","abs","paddingAmount","round","paddingAxis","createPaddingTensor","paddingTensorShape","shape","slice","fill","paddingTensorAppend","remainingPaddingAmount","paddingTensorPrepend","tensorsToStack","filter","t","map","toFloat","concat"],"sources":["../../../src/ops/padToSquare.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}