{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hurle\\\\School\\\\Spring 2022\\\\AIM\\\\emo7ion3\\\\emo7ion\\\\App\\\\src\\\\pages\\\\video.js\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar cv = require('./video_files/opencv.js');\n\nvar Utils = require('./video_files/utils.js');\n\nfunction Video() {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 10,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"cam_input\",\n      height: \"240\",\n      width: \"320\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: \"canvas_output\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_c = Video;\n\nfunction openCvReady() {\n  cv['onRuntimeInitialized'] = () => {\n    let video = document.getElementById(\"cam_input\"); // video is the id of video tag\n\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: false\n    }).then(function (stream) {\n      video.srcObject = stream;\n      video.play();\n    }).catch(function (err) {\n      console.log(\"An error occurred! \" + err);\n    });\n    let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);\n    let dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);\n    let gray = new cv.Mat();\n    let cap = new cv.VideoCapture(cam_input);\n    let faces = new cv.RectVector();\n    let classifier = new cv.CascadeClassifier();\n    let utils = new Utils('errorMessage');\n    let faceCascadeFile = 'haarcascade_frontalface_default.xml'; // path to xml\n\n    utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\n      classifier.load(faceCascadeFile); // in the callback, load the cascade from file\n    });\n    const FPS = 40;\n\n    function processVideo() {\n      let canvas = document.getElementById('canvas_output');\n      let ctx = canvas.getContext('2d');\n      let begin = Date.now();\n      cap.read(src);\n      src.copyTo(dst);\n      cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);\n\n      try {\n        classifier.detectMultiScale(gray, faces, 1.1, 3, 0);\n        console.log(faces.size());\n      } catch (err) {\n        console.log(err);\n      }\n\n      for (let i = 0; i < faces.size(); ++i) {\n        let face = faces.get(i);\n        let point1 = new cv.Point(face.x, face.y);\n        let point2 = new cv.Point(face.x + face.width, face.y + face.height);\n        cv.rectangle(dst, point1, point2, [255, 0, 0, 255]); //ctx.beginPath();\n        //ctx.moveTo(face.x, face.y);\n        //ctx.lineTo(face.x + face.width, face.y + face.height);\n        //ctx.stroke();\n        //ctx.lineWidth = 10;\n        //base_image = new Image();\n        //base_image.src = 'emojis/happy.png';\n        //base_image.onload = function(){\n        //console.log(\"here\");\n        //}\n      }\n\n      cv.imshow(\"canvas_output\", dst); // schedule next one.\n\n      let delay = 1000 / FPS - (Date.now() - begin);\n      setTimeout(processVideo, delay);\n    } // schedule first one.\n\n\n    setTimeout(processVideo, 0);\n  };\n}\n\nexport default Video;\n\nvar _c;\n\n$RefreshReg$(_c, \"Video\");","map":{"version":3,"sources":["C:/Users/hurle/School/Spring 2022/AIM/emo7ion3/emo7ion/App/src/pages/video.js"],"names":["React","cv","require","Utils","Video","openCvReady","video","document","getElementById","navigator","mediaDevices","getUserMedia","audio","then","stream","srcObject","play","catch","err","console","log","src","Mat","height","width","CV_8UC4","dst","CV_8UC1","gray","cap","VideoCapture","cam_input","faces","RectVector","classifier","CascadeClassifier","utils","faceCascadeFile","createFileFromUrl","load","FPS","processVideo","canvas","ctx","getContext","begin","Date","now","read","copyTo","cvtColor","COLOR_RGBA2GRAY","detectMultiScale","size","i","face","get","point1","Point","x","y","point2","rectangle","imshow","delay","setTimeout"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nvar cv = require('./video_files/opencv.js');\r\nvar Utils = require('./video_files/utils.js')\r\n\r\n\r\nfunction Video(){\r\n    return(\r\n      <>\r\n        <h1>Video</h1>\r\n        <video id=\"cam_input\" height=\"240\" width=\"320\"></video>\r\n        <canvas id=\"canvas_output\"></canvas>\r\n      </>\r\n        );\r\n}\r\n\r\nfunction openCvReady() {\r\n  cv['onRuntimeInitialized']=()=>{\r\n    let video = document.getElementById(\"cam_input\"); // video is the id of video tag\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: false })\r\n    .then(function(stream) {\r\n        video.srcObject = stream;\r\n        video.play();\r\n    })\r\n    .catch(function(err) {\r\n        console.log(\"An error occurred! \" + err);\r\n    });\r\n    let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);\r\n    let dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);\r\n    let gray = new cv.Mat();\r\n    let cap = new cv.VideoCapture(cam_input);\r\n    let faces = new cv.RectVector();\r\n    let classifier = new cv.CascadeClassifier();\r\n    let utils = new Utils('errorMessage');\r\n    let faceCascadeFile = 'haarcascade_frontalface_default.xml'; // path to xml\r\n    utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\r\n    classifier.load(faceCascadeFile); // in the callback, load the cascade from file\r\n});\r\n    const FPS = 40;\r\n    function processVideo() {\r\n\r\n        let canvas = document.getElementById('canvas_output');\r\n        let ctx = canvas.getContext('2d');\r\n\r\n\r\n        let begin = Date.now();\r\n        cap.read(src);\r\n        src.copyTo(dst);\r\n        cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);\r\n        try{\r\n            classifier.detectMultiScale(gray, faces, 1.1, 3, 0);\r\n            console.log(faces.size());\r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n        for (let i = 0; i < faces.size(); ++i) {\r\n            let face = faces.get(i);\r\n            let point1 = new cv.Point(face.x, face.y);\r\n            let point2 = new cv.Point(face.x + face.width, face.y + face.height);\r\n            cv.rectangle(dst, point1, point2, [255, 0, 0, 255]);\r\n            //ctx.beginPath();\r\n            //ctx.moveTo(face.x, face.y);\r\n            //ctx.lineTo(face.x + face.width, face.y + face.height);\r\n            //ctx.stroke();\r\n            //ctx.lineWidth = 10;\r\n\r\n            //base_image = new Image();\r\n            //base_image.src = 'emojis/happy.png';\r\n            //base_image.onload = function(){\r\n\r\n              //console.log(\"here\");\r\n            //}\r\n        }\r\n        cv.imshow(\"canvas_output\", dst);\r\n        // schedule next one.\r\n        let delay = 1000/FPS - (Date.now() - begin);\r\n        setTimeout(processVideo, delay);\r\n}\r\n  // schedule first one.\r\n  setTimeout(processVideo, 0);\r\n};\r\n}\r\nexport default Video\r\n"]},"metadata":{},"sourceType":"module"}